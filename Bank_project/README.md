# Прогнозирование оттока клиентов Банка

## Описание проекта:
Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых. Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Нам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 

Необходимо построить модель с предельно большим значением F1-меры и измерить AUC-ROC, сравнивая её значение с F1-мерой.

Источник данных: [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)

## Навыки и инструменты:
`Машинное обучение`
`Классификация`
`Pandas` 
`Scikit-learn`
`Matplotlib` 
`Seaborn`
`Pipeline`
`GridSearchCV`

## Проделанная работа:
- Был проведен предварительный анализ данных.
- Удалены данные не несущие полезной для задачи информации. 
- Обработаны категориальные признаки и проведена стандартизация численных признаков с использованием make_column_transformer.
- Проведен выбор модели МО, подбор гиперпараметров с помощью GridSearchCV.
- Использовано 3 метода борьбы с дисбалансом классов.

## Вывод:

1. Перед началом исследования данные были подготовлены:
    - удалены признаки, которые не несут ценности для обучения модели,
    - обработаны пропущенные значения,
    - закодированы категориальные признаки методом прямого кодирования (One-Hot Encoding),
    - исходный датафрейм был разделён на две выборки: обучающую (75%) и тестовую (25%),
    - количественные признаки были масштабированы.

<br>

2. В исследовании участвовали три различные алгоритма классификации: Дерево решений (Decision Tree), Случайный лес (Random Forest) и Логистическая регрессия (Logistic Regression). У каждой модели менялись гиперпараметры, чтобы добиться наиболее высокой оценки качества.

<br>

3. Обучение моделей проводилось как на несбалансированных исходных данных, так и с применением методов борьбы с дисбалансом:
    - взвешивание классов, 
    - увеличение выборки (Upsampling),
    - уменьшение выборки (Downsampling).

<br>

4. По итогам исследования был сделан вывод, что для прогнозирования ухода клиента из банка наиболее подходящей моделью является модель, построенная на **алгоритме Случайного леса (Random Forest) с количеством деревьев 90 и максимальной глубиной дерева 7**. Такой результат был достигнут с применением **метода увеличения выборки (Upsampling)**.

<br>

5. Итоговое значение качества модели F1-мера на тестовой выборке составляет 0.64. Модель характеризуется высоким показателем полноты = 0.68 (min = 0, max = 1), поэтому она с высокой вероятностью предскажет уход клиента из банка. С точки зрения бизнеса полученная модель поможет маркетологам лучше определять килентов, которые могут уйти в ближайшее время. Для улучшения модели следует использовать данные, отражающие отношения клиента с банком в динамике.
