# Обучение модели классификации комментариев

## Описание проекта:

Интернет-магазин «Викишоп» запускает новый сервис. Теперь пользователи могут редактировать и дополнять описания товаров, как в вики-сообществах. То есть клиенты предлагают свои правки и комментируют изменения других. Магазину нужен инструмент, который будет искать токсичные комментарии и отправлять их на модерацию. 

Необходимо обучить модель классифицировать комментарии на позитивные и негативные. В нашем распоряжении набор данных с разметкой о токсичности правок.

Значение метрики качества *F1* должно быть не меньше 0.75. 

Данные находятся в файле `toxic_comments.csv`. Столбец *text* в нём содержит текст комментария, а *toxic* — целевой признак.

<br>

## Навыки и инструменты:
`Машинное обучение`
`Классификация`
`Предобработка данных`
`NLP`
`Pandas` 
`Scikit-learn`
`Matplotlib` 
`Seaborn`
`nltk`
`GridSearchCV`
`LogisticRegression`
`CatBoostClassifier`
`re`
`tqdm`

<br>

## Вывод:

Цель настоящего исследования - подготовить прототип модели машинного обучения. Модель должна классифицировать комментарии на позитивные и негативные. В нашем распоряжении набор данных с разметкой о токсичности правок. Заказчик - интернет-магазин, который запускает новый сервис. Теперь пользователи могут редактировать и дополнять описания товаров, как в вики-сообществах. То есть клиенты предлагают свои правки и комментируют изменения других. Магазину нужен инструмент, который будет искать токсичные комментарии и отправлять их на модерацию. 


1. В нашем распоряжении были данные по 159292 комментариям. Тексты были написаны на английском языке и содержали лишние знаки и символы. В целевом признаке наблюдался дисбаланс классов (90% объектов принадлежали к 0-му классу).

   <br>

   <img width="800" alt="Screenshot_113" src="https://github.com/elena-iliushina/Portfolio/assets/133641038/b40bd1c6-32fe-4be9-a5e3-932911ccb69d">

  <br>

<br>

2. Перед началом исследования данные были подготовлены:
    - удален признак, не несущий ценности для дальнейшего обучения модели,
    - тексты комментариев очищены от ненужных знаков, убраны стоп-слова, проведена лемматизация,
    - для устранения дисбаланса было решено применить метод взвешивания классов,
    - для обучающей и тестовой выборки были созданы матрицы TF-IDF для оценки важности каждого слова.   
    
<br>    

3. В обучении модели участвовали три различных алгоритма: Логистическая регрессия (Logistic Regression), Дерево решений (Decision Tree Classifier) и Градиентный бустинг (Cat Boost Classifier). У каждой модели менялись гиперпараметры, чтобы добиться наиболее высокой оценки качества. Оценкой качества модели была выбрана метрика F1 - средневзвешенная мера точности (precision) и полноты (recall) модели.

   <br>

    <img width="500" alt="Screenshot_112" src="https://github.com/elena-iliushina/Portfolio/assets/133641038/653e1738-8a81-4849-81e6-495cedc3c55a">


   <br>

<br>

4. По итогам исследования был сделан вывод, что для классификации комментариев на позитивные и негативные наиболее подходящей моделью является модель, построенная на **алгоритме градиентного бусинга (Cat Boost Classifier) с использованием метода взвешивания классов с глубиной дерева = 6, скоростью обучения 0,1 и количеством итераций 1500. Финальное значение метрики F1 = 0.76.

   <br>

    <img width="800" alt="Screenshot_114" src="https://github.com/elena-iliushina/Portfolio/assets/133641038/51f2d355-2897-46ab-97fd-70ad709d3892">



   <br>


