# Восстановление золота из руды

## Описание проекта:
Компания «Цифры» разрабатывает решения для эффективной работы промышленных предприятий. Необходимо подготовить прототип модели машинного обучения. Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. В нашем распоряжении данные с параметрами добычи и очистки. 

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Требуется:

1. Подготовить данные;
2. Провести исследовательский анализ данных;
3. Построить и обучить модель.
<br>

**Технологический процесс:**
- `Rougher feed` — исходное сырье;
- `Rougher additions (или reagent additions)` — флотационные реагенты: Xanthate, Sulphate, Depressant;

    - Xanthate — ксантогенат (промотер, или активатор флотации);
    - Sulphate — сульфат (на данном производстве сульфид натрия);
    - Depressant — депрессант (силикат натрия).
    
    
- `Rougher process` — флотация;
- `Rougher tails` — отвальные хвосты;
- `Float banks` — флотационная установка;
- `Cleaner process` — очистка;
- `Rougher Au` — черновой концентрат золота;
- `Final Au` — финальный концентрат золота.

<br>

**Параметры этапов:**
- `air amount` — объём воздуха;
- `fluid levels` — уровень жидкости;
- `feed size` — размер гранул сырья;
- `feed rate` — скорость подачи.

<br>

Нужно спрогнозировать сразу две величины:
- эффективность обогащения чернового концентрата `rougher.output.recovery`;
- эффективность обогащения финального концентрата `final.output.recovery`.

<br>

## Навыки и инструменты:
`Машинное обучение`
`Регрессия`
`EDA`
`Pandas` 
`NumPy`
`Scikit-learn`
`Matplotlib` 
`Seaborn`
`Pipeline`
`GridSearchCV`
`make_column_transformer`
`StandardScaler`
`RandomForestRegressor`
`LinearRegression`
`CatBoostRegressor`

<br>

## Проделанная работа:
- Был проведен предварительный анализ данных.
- Сделан EDA.
- Построена модель, которая предсказывает коэффициент восстановления золота из золотосодержащей руды на основе данных с параметрами добычи и очистки.
- Проведена стандартизация численных признаков с использованием make_column_transformer.
- Проведен выбор модели МО, подбор гиперпараметров с помощью GridSearchCV.
- Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

<br>

## Вывод:

1. Перед началом исследования данные были подготовлены:
    - обработаны пропущенные значения,
    - в тестовую выборку из исходных данных были добавлены целевые признаки - эффективность обогащения чернового концентрата и эффективность обогащения финального концентрата,
    - была проведена проверка корректности расчетов эффективности обогащения.
    
    
2. На следующем этапе был проведен исследовательский анализ данных, по результатам которого было выявлено, что:
    - концентрация золота и свинца после каждого этапа очистки увеличивается, что нельзя сказать о доле серебра. После флотации концентрация серебра увеличивается, а затем постепенно уменьшается так, что финальная концентрация серебра в среднем меньше, чем в исходном сырье,
    - распределения размеров гранул сырья на обучающей и тестовой выборках имеют схожий характер,
    - суммарная концентрация всех веществ увеличивается после флотации, а к финальному этапу диапазон распределения суммарной концентрации веществ уменьшается.
  
<br>

<img width="800" alt="Screenshot_83" src="https://github.com/elena-iliushina/Portfolio/assets/133641038/e4184759-66cf-48e4-a7ee-d496c2ffb66a">
<img width="800" alt="Screenshot_84" src="https://github.com/elena-iliushina/Portfolio/assets/133641038/912bb9f9-d08e-4bf5-9bc0-da6abbc81464">


<br>

<br>


3. В обучении модели участвовали четыре различные алгоритма: Линейная регрессия (Linear Regression), Дерево решений (Decision Tree Regressor), Случайный лес (Random Forest Regressor) и Градиентный бустинг (Cat Boost Regressor). У каждой модели менялись гиперпараметры, чтобы добиться наиболее высокой оценки качества.


<br>

<img width="800" alt="Screenshot_85" src="https://github.com/elena-iliushina/Portfolio/assets/133641038/daa65033-51c3-4d12-ae98-8e02940cc344">


<br>

4. Оценкой качества модели была выбрана метрика sMAPE - симметричное среднее абсолютное процентное отклонение. По итогам исследования был сделан вывод, что для прогнозирования коэффициента восстановления золота из золотосодержащей руды наиболее подходящей моделью является модель, построенная на **алгоритме Градиентного бустинга (Cat Boost Regressor) с глубиной дерева 6 и количеством итераций 1000 для чернового концетрата и глубиной дерева 3 и количеством итераций 500 для финального концетрата при заданной скорости обучения 0.01**.
  
5. Итоговое значение качества модели sMAPE на тестовой выборке составляет 8.45. При проверке модели на адекватность сделан вывод, что она показывает лучший результат, чем константная модель.

<br>

<img width="800" alt="Screenshot_86" src="https://github.com/elena-iliushina/Portfolio/assets/133641038/84a819e1-136a-4a4a-bc6f-c3042312e599">

<img width="800" alt="Screenshot_87" src="https://github.com/elena-iliushina/Portfolio/assets/133641038/4fce6d68-5f53-4551-92c6-7b910395d9d5">





