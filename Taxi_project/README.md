# Прогнозирование заказов такси

## Описание проекта:
Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Наша задача - построить модель для такого предсказания.

Значение метрики *RMSE* на тестовой выборке должно быть не больше 48.

Требуется:

1. Загрузить данные и выполнить их ресемплирование по одному часу.
2. Проанализировать данные.
3. Обучить разные модели с различными гиперпараметрами. Сделать тестовую выборку размером 10% от исходных данных.
4. Проверить данные на тестовой выборке и сделать выводы.


`num_orders` - целевой признак (количество заказов). 

<br>

## Навыки и инструменты:
`Машинное обучение`
`Регрессия`
`Временные ряды`
`Pandas` 
`NumPy`
`Scikit-learn`
`Matplotlib` 
`Seaborn`
`statsmodels`
`GridSearchCV`
`RandomForestRegressor`
`LinearRegression`
`CatBoostRegressor`

<br>

## Проделанная работа:
- Был проведен предварительный анализ данных.
- Проведено ресемплирование данных по одному часу.
- Построена модель, которая предсказывает количество заказов такси на следующий час.
- Проведен выбор модели МО, подбор гиперпараметров с помощью GridSearchCV.

<br>

## Вывод:

1. В нашем распоряжении были данные по количеству заказов такси с интервалом 10 минут с 1 марта 2018 года по 31 августа 2018 года. На первом этапе было проведено ресемплирование данных по одному часу, в итоге получился датафрейм на 4416 строк с целевым признаком "количество заказов".

<br>

2. За время наблюдений наметился определенный тренд на общее увеличение заказов такси в течение часа. Вероятно, это вызвано ростом компании, так как есть гипотеза, что бизнес, связанный с такси не имеет месячной сезонности. Но данную гипотезу можно подтвердить или опровергнуть только имея данные за несколько лет. Помимо этого на графиках видна суточная сезонность. Ночью количество заказов стремится к нулю, а вечер - момент самого сильного спроса на услуги такси.

   <br>
  
   <img width="800" alt="Screenshot_106" src="https://github.com/elena-iliushina/Portfolio/assets/133641038/d427345d-a3da-41fd-b2c4-2991469e5bd4">
   
   <img width="800" alt="Screenshot_107" src="https://github.com/elena-iliushina/Portfolio/assets/133641038/57e25a79-bcfe-4f15-806f-dd4beedb805b">

   <br>

<br>

3. Перед обучением моделей в данные были добавлены новые показатели: месяц, день, день недели, час, фактор lag для определения интервала на котором обучается модель и скользящее среднее. Данные были разделены на обучающую и тестовую выборку в отношении 9:1.

<br>

4. В обучении модели участвовали четыре различных алгоритма: Линейная регрессия (Linear Regression), Случайный лес (Random Forest Regressor), Градиентный бустинг (Cat Boost Regressor) и Стохастический градиентный бустинг (Light GBM). У каждой модели менялись гиперпараметры, чтобы добиться наиболее высокой оценки качества. Оценкой качества модели была выбрана метрика RSME - среднеквадратичная ошибка, которая сообщает нам среднее расстояние между прогнозируемыми значениями из модели и фактическими значениями в наборе данных.

<br>


  

